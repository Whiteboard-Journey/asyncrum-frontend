"use strict";(self.webpackChunkasyncrum=self.webpackChunkasyncrum||[]).push([[656],{63546:function(e,t,i){i.r(t),i.d(t,{default:function(){return z}});var a=i(37762),s=i(29439),r=i(9140),l=i(95316),n=i(8476),o=i(47798),d=i(12576),c=i(8116),h=i(89743),m=i(2677),u=i(43360),p=i(56144),x=i(43504),j=i(72791),f=i(10765),b=i(74569),g=i.n(b),v=i(9478),Z=i(56819),N=i(72426),w=i.n(N),y=i(96766);i(65141);function I(){var e=(0,f.OT)(),t=(0,s.Z)(e,2),i=t[0],a=t[1],r=(0,j.useState)(),l=(0,s.Z)(r,2),n=l[0],o=l[1],d=(0,j.useState)(""),c=(0,s.Z)(d,2),h=c[0],m=c[1],u=(0,j.useState)(!1),p=(0,s.Z)(u,2),x=p[0],b=p[1];return{isOpen:i,size:n,className:h,scroll:x,toggleModal:a,openModalWithSize:function(e){o(e),m(""),b(!1),a()},openModalWithClass:function(e){m(e),b(!1),a()},openModalWithScroll:function(){b(!0),o("sm"),m(""),a()}}}var U=i(13851),S=i(80184),D=JSON.parse(sessionStorage.getItem("asyncrum_user")),k="/whiteboard?url=",A=function(e){e.preventDefault();var t=e.target.elements.title.value,i=e.target.elements.description.value;g().post("".concat(v.Z.API_URL+"/api/v1/whiteboards"),{title:t,description:i,scope:"team"},{headers:{Authorization:"Bearer "+D.token}}).then((function(e){var i=e.data.preSignedURL,a=e.data.id,s={id:"doc",name:"New Document",version:Z.J2.version,pages:{page:{id:"page",name:"Page 1",childIndex:1,shapes:{},bindings:{}}},pageStates:{page:{id:"page",selectedIds:[],camera:{point:[0,0],zoom:1}}},assets:{}},r={name:s.name||"New Document",fileHandle:null,document:s,assets:{}},l=JSON.stringify(r,null,2),n=new Blob([l],{type:"application/vnd.Tldraw+json"}),o=new File([n],t),d=new FormData;d.append("data",o),g().create({transformRequest:[function(e,t){return delete t.common.Authorization,t["content-type"]="application/octet-stream",d}]}).put(i,d).then((function(){g().get("".concat(v.Z.API_URL+"/api/v1/whiteboards/"+a),{headers:{Authorization:"Bearer "+D.token}}).then((function(e){window.location.href=k+e.data.whiteboardUrl+"&id="+a}))}))}))},B=function(e){e.preventDefault();var t=e.target.elements.id.value,i=e.target.elements.title.value,a=e.target.elements.description.value;g().patch("".concat(v.Z.API_URL+"/api/v1/whiteboards/"+t),{title:i,description:a,scope:""},{headers:{Authorization:"Bearer "+D.token}}).then((function(){return window.location.reload()}))},R=function(e){var t=new Date(e);return t.setTime(t.getTime()-60*t.getTimezoneOffset()*1e3),t},F=function(e){return w()(R(e)).fromNow()},C=function(e){e.preventDefault();var t=e.target.elements.id.value;g().delete("".concat(v.Z.API_URL+"/api/v1/whiteboards/"+t),{headers:{Authorization:"Bearer "+D.token}}).then((function(){return window.location.reload()}))},O=function(e){var t=e.dailyStandup,i=I(),a=i.isOpen,s=i.size,n=i.className,o=i.scroll,d=i.toggleModal,c=i.openModalWithClass;return(0,S.jsx)(r.Z,{className:"d-block me-3",children:(0,S.jsxs)(r.Z.Body,{onClick:function(){c("modal-full-width"),function(e){var t={title:null,description:null,scope:"team"};g().patch(v.Z.API_URL+"/api/v1/records/"+e[0],t,{headers:{Authorization:"Bearer "+D.token}}),g().patch(v.Z.API_URL+"/api/v1/records/"+e[1],t,{headers:{Authorization:"Bearer "+D.token}})}(t.id)},style:{cursor:"pointer"},children:[(0,S.jsx)("div",{className:(t.seen?"opacity-25":"")+" text-center",children:(0,S.jsx)("img",{src:t.profileImageUrl,className:"rounded-circle avatar-lg",alt:t.author,referrerPolicy:"no-referrer"})}),(0,S.jsx)("h4",{className:(t.seen?"text-light":"")+" text-center font-weight-bold mt-2",children:t.author}),(0,S.jsx)("p",{className:(t.seen?"text-light":"text-muted")+" text-center font-12 mb-1",children:F(t.createdDate)}),(0,S.jsx)(l.Z,{show:a,onHide:d,dialogClassName:n,size:s,scrollable:o,children:(0,S.jsxs)(l.Z.Body,{children:[(0,S.jsx)(l.Z.Header,{onHide:d,closeButton:!0,children:(0,S.jsx)("h4",{className:"modal-title",children:t.author+" - "+F(t.createdDate)})}),(0,S.jsx)("video",{src:t.camRecordFileUrl,controls:!0,autoPlay:!0,playsInline:!0,width:320,height:240,style:{marginLeft:"auto",marginRight:"auto",display:"block"}}),(0,S.jsx)("video",{src:t.screenRecordFileUrl,controls:!0,autoPlay:!0,playsInline:!0,width:960,height:540,style:{marginLeft:"auto",marginRight:"auto",display:"block"}})]})})]})})},L=function(e){var t=e.whiteboard,i=(0,f.OT)(),a=(0,s.Z)(i,2),c=a[0],h=a[1],m=(0,f.OT)(),u=(0,s.Z)(m,2),p=u[0],b=u[1],g=(0,j.useState)(!0),v=(0,s.Z)(g,2),Z=v[0],N=v[1];return(0,S.jsx)(r.Z,{className:"d-block",children:(0,S.jsxs)(r.Z.Body,{children:[(0,S.jsxs)(n.Z,{className:"card-widgets",align:"end",children:[(0,S.jsx)(n.Z.Toggle,{variant:"link",as:"a",className:"card-drop arrow-none cursor-pointer p-0 shadow-none",children:(0,S.jsx)("i",{className:"dripicons-dots-3"})}),(0,S.jsxs)(n.Z.Menu,{children:[(0,S.jsx)(n.Z.Item,{children:"Share"}),(0,S.jsx)(n.Z.Item,{onClick:h,children:"Edit"}),(0,S.jsx)(l.Z,{show:c,onHide:h,children:(0,S.jsxs)(l.Z.Body,{children:[(0,S.jsx)(l.Z.Header,{onHide:h,closeButton:!0,children:(0,S.jsx)("h4",{className:"modal-title",children:"Edit Whiteboard Information"})}),(0,S.jsxs)("form",{className:"ps-3 pe-3",onSubmit:B,children:[(0,S.jsx)("input",{type:"hidden",id:"id",value:t.id}),(0,S.jsxs)("div",{className:"mt-3 mb-3",children:[(0,S.jsx)("label",{htmlFor:"title",className:"form-label",children:"Title"}),(0,S.jsx)("input",{className:"form-control",type:"text",id:"title",maxLength:255,required:!0,placeholder:t.title})]}),(0,S.jsxs)("div",{className:"mb-3",children:[(0,S.jsx)("label",{htmlFor:"description",className:"form-label",children:"Description"}),(0,S.jsx)("input",{className:"form-control",type:"text",id:"description",maxLength:255,required:!0,placeholder:t.description})]}),(0,S.jsx)("div",{className:"mb-3 text-center",children:(0,S.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Edit"})})]})]})}),(0,S.jsx)(n.Z.Item,{children:"Duplicate"}),(0,S.jsx)(n.Z.Item,{className:"text-danger",onClick:b,children:"Delete"}),(0,S.jsx)(l.Z,{show:p,onHide:b,children:(0,S.jsxs)(l.Z.Body,{children:[(0,S.jsx)(l.Z.Header,{onHide:b,closeButton:!0,children:(0,S.jsxs)("h4",{className:"modal-title",children:["Delete ",t.title]})}),(0,S.jsx)("p",{className:"mt-4 mb-4 text-center font-weight-bolds",children:"Are you sure you want to delete this whiteboard permanently?"}),(0,S.jsxs)("form",{className:"ps-3 pe-3",onSubmit:C,children:[(0,S.jsx)("input",{type:"hidden",id:"id",value:t.id}),(0,S.jsx)("div",{className:"mb-3 text-center",children:(0,S.jsx)("button",{className:"btn btn-danger",type:"submit",children:"Delete"})})]})]})})]})]}),(0,S.jsx)("h4",{className:"mt-0",children:(0,S.jsx)(x.rU,{to:k+t.whiteboardFileUrl+"&id="+t.id,className:"text-title",children:t.title.length>25?t.title.slice(0,25)+" ...":t.title})}),t.description&&(0,S.jsxs)("p",{className:"font-13 my-3",children:[Z?t.description.slice(0,35):t.description,t.description.length>35?(0,S.jsx)("span",{onClick:function(){N(!Z)},className:"fw-bold text-info",role:"button",children:Z?" ...read more":" show less"}):""]}),(0,S.jsxs)("div",{children:[(0,S.jsx)("span",{className:"font-13",children:"Author: "}),(0,S.jsx)(o.Z,{placement:"bottom",overlay:(0,S.jsx)(d.Z,{children:t.author}),children:(0,S.jsx)("img",{src:t.authorProfileImageUrl,className:"rounded-circle avatar-xs",alt:t.author})})]}),(0,S.jsxs)("p",{className:"text-muted text-end font-12 mt-3 mb-1",children:["Last modified: ",F(t.lastModifiedDate)]})]})})},z=function(){var e=(0,j.useState)([]),t=(0,s.Z)(e,2),i=t[0],r=t[1],n=(0,j.useState)(!0),o=(0,s.Z)(n,2),d=o[0],x=o[1],b=(0,f.OT)(),Z=(0,s.Z)(b,2),N=Z[0],D=Z[1],k=I(),B=k.isOpen,F=k.size,C=k.className,z=k.scroll,H=k.toggleModal,M=k.openModalWithClass,P=(0,j.useState)([]),T=(0,s.Z)(P,2),_=T[0],W=T[1],G=(0,j.useState)(!0),E=(0,s.Z)(G,2),q=E[0],J=E[1],V=(0,j.useState)(1),K=(0,s.Z)(V,2),Q=K[0],X=K[1],Y=(0,j.useState)(0),$=(0,s.Z)(Y,2),ee=$[0],te=$[1],ie=(0,j.useRef)(null);(0,j.useEffect)((function(){var e=JSON.parse(sessionStorage.getItem("asyncrum_user")),t=[];g().get(v.Z.API_URL+"/api/v1/records?scope=team&pageIndex=0&topId=0",{headers:{Authorization:"Bearer "+e.token}}).then((function(i){var s,r=(0,a.Z)(i.data.records);try{for(r.s();!(s=r.n()).done;){var l,n,o,d,c,h=s.value;if(!(w()().diff(w()(R(h.createdDate)),"hours")>24&&(null===(l=h.seenMemberIdGroup)||void 0===l?void 0:l.indexOf(e.id))>-1))if((null===(n=t.at(-1))||void 0===n?void 0:n.author)===h.author.fullname&&(null===(o=t.at(-1))||void 0===o?void 0:o.title.slice(0,13))===h.title.slice(0,13))"screen"===h.title.slice(-6)?(t.at(-1).id.push(h.id),t.at(-1).screenRecordFileUrl=h.recordFileUrl):(t.at(-1).id.push(h.id),t.at(-1).camRecordFileUrl=h.recordFileUrl);else if("screen"===h.title.slice(-6))t.push({id:[h.id],author:h.author.fullname,title:h.title,profileImageUrl:h.author.profileImageUrl,createdDate:h.createdDate,camRecordFileUrl:"",screenRecordFileUrl:h.recordFileUrl,seen:(null===(d=h.seenMemberIdGroup)||void 0===d?void 0:d.indexOf(e.id))>-1});else t.push({id:[h.id],author:h.author.fullname,title:h.title,profileImageUrl:h.author.profileImageUrl,createdDate:h.createdDate,camRecordFileUrl:h.recordFileUrl,screenRecordFileUrl:"",seen:(null===(c=h.seenMemberIdGroup)||void 0===c?void 0:c.indexOf(e.id))>-1})}}catch(u){r.e(u)}finally{r.f()}W(t.reverse()),J(!1);var m=t.findIndex((function(e){return!e.seen}));ie&&ie.current&&ie.current.goToSlide(m)}))}),[]),(0,j.useEffect)((function(){var e=JSON.parse(sessionStorage.getItem("asyncrum_user")),t=[];g().get(v.Z.API_URL+"/api/v1/whiteboards?scope=team&pageIndex=".concat(Q-1,"&topId=0"),{headers:{Authorization:"Bearer "+e.token}}).then((function(e){var i,s=(0,a.Z)(e.data.whiteboards);try{for(s.s();!(i=s.n()).done;){var l=i.value;t.push({id:l.id,title:l.title,description:l.description,createdDate:l.createdDate,lastModifiedDate:l.lastModifiedDate,scope:l.scope,author:l.author.fullname,authorProfileImageUrl:l.author.profileImageUrl,whiteboardFileUrl:l.whiteboardFileUrl})}}catch(n){s.e(n)}finally{s.f()}r(t),te(e.data.size_ALL_PAGE),x(!1)}))}),[Q]);var ae=function(){for(var e=[],t=function(e){X(parseInt(e.target.innerText))},i=1;i<=Math.ceil(ee/12);i++)e.push((0,S.jsx)(c.Z.Item,{active:i===Q,onClick:t,children:i},i.toString()));return(0,S.jsxs)(c.Z,{className:"mx-auto",children:[(0,S.jsx)(c.Z.Prev,{}),e,(0,S.jsx)(c.Z.Next,{})]})};return(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(h.Z,{children:(0,S.jsx)(m.Z,{children:(0,S.jsx)("div",{className:"page-title-box",children:(0,S.jsx)("h4",{className:"page-title",children:"Daily Standups"})})})}),(0,S.jsx)(h.Z,{className:"mb-4",children:(0,S.jsxs)(m.Z,{children:[(0,S.jsxs)(u.Z,{onClick:function(){M("modal-full-width")},children:[(0,S.jsx)("i",{className:"mdi mdi-plus"})," Record"]}),(0,S.jsx)(l.Z,{show:B,onHide:H,dialogClassName:C,size:F,scrollable:z,children:(0,S.jsxs)(l.Z.Body,{children:[(0,S.jsx)(l.Z.Header,{onHide:H,closeButton:!0,children:(0,S.jsx)("h4",{className:"modal-title",children:"Record"})}),(0,S.jsx)(U.SB,{})]})})]})}),(0,S.jsx)(h.Z,{children:!q&&(0,S.jsx)(y.default,{ref:ie,additionalTransfrom:0,arrows:!0,centerMode:!1,className:"",containerClass:"container",dotListClass:"",draggable:!0,focusOnSelect:!1,infinite:!1,itemClass:"",keyBoardControl:!0,minimumTouchDrag:80,pauseOnHover:!0,renderArrowsWhenDisabled:!1,renderButtonGroupOutside:!1,renderDotsOutside:!1,responsive:{desktop:{breakpoint:{max:3e3,min:1024},items:6,partialVisibilityGutter:40},mobile:{breakpoint:{max:464,min:0},items:1,partialVisibilityGutter:30},tablet:{breakpoint:{max:1024,min:464},items:2,partialVisibilityGutter:30}},rewind:!1,rewindWithAnimation:!1,rtl:!1,shouldResetAutoplay:!0,showDots:!1,sliderClass:"",slidesToSlide:1,children:_.map((function(e,t){return(0,S.jsx)("div",{children:(0,S.jsx)(O,{dailyStandup:e})})}))})}),(0,S.jsx)("hr",{}),(0,S.jsx)(h.Z,{children:(0,S.jsx)(m.Z,{children:(0,S.jsx)("div",{className:"page-title-box",children:(0,S.jsx)("h4",{className:"page-title",children:"Whiteboards"})})})}),(0,S.jsx)(h.Z,{children:(0,S.jsx)(m.Z,{})}),(0,S.jsxs)(h.Z,{className:"mb-2",children:[(0,S.jsxs)(m.Z,{sm:4,children:[(0,S.jsxs)(u.Z,{onClick:D,children:[(0,S.jsx)("i",{className:"mdi mdi-plus"})," Create Whiteboard"]}),(0,S.jsx)(l.Z,{show:N,onHide:D,children:(0,S.jsxs)(l.Z.Body,{children:[(0,S.jsx)(l.Z.Header,{onHide:D,closeButton:!0,children:(0,S.jsx)("h4",{className:"modal-title",children:"Create a new whiteboard"})}),(0,S.jsxs)("form",{className:"ps-3 pe-3",onSubmit:A,children:[(0,S.jsxs)("div",{className:"mt-3 mb-3",children:[(0,S.jsx)("label",{htmlFor:"title",className:"form-label",children:"Title"}),(0,S.jsx)("input",{className:"form-control",type:"text",id:"title",maxLength:255,required:!0,placeholder:"Untitled"})]}),(0,S.jsxs)("div",{className:"mb-3",children:[(0,S.jsx)("label",{htmlFor:"description",className:"form-label",children:"Description"}),(0,S.jsx)("input",{className:"form-control",type:"textarea",id:"description",maxLength:255,required:!0,placeholder:"Description"})]}),(0,S.jsx)("div",{className:"mb-3 text-center",children:(0,S.jsx)("button",{className:"btn btn-primary",type:"submit",children:"Create"})})]})]})})]}),(0,S.jsx)(m.Z,{sm:8,children:(0,S.jsxs)("div",{className:"text-sm-end",children:[(0,S.jsx)("div",{className:"btn-group mb-3",children:(0,S.jsx)(u.Z,{variant:"primary",children:"All"})}),(0,S.jsxs)(p.Z,{className:"mb-3 ms-1",children:[(0,S.jsx)(u.Z,{variant:"light",children:"Owned by me"}),(0,S.jsx)(u.Z,{variant:"light",children:"Not owned by me"})]})]})})]}),!d&&(0,S.jsxs)(S.Fragment,{children:[(0,S.jsx)(h.Z,{children:i.map((function(e,t){return(0,S.jsx)(m.Z,{md:6,xxl:3,children:(0,S.jsx)(L,{whiteboard:e})},"wb-"+e.id)}))}),(0,S.jsx)(h.Z,{children:(0,S.jsx)(m.Z,{className:"d-flex",children:(0,S.jsx)(ae,{})})})]})]})}}}]);
//# sourceMappingURL=656.0508d1dc.chunk.js.map